<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://kit.fontawesome.com/c1095fcd87.js" crossorigin="anonymous"></script>


    <link rel="stylesheet" href="css/main.css">
    <title>Kamal Shah Champions Technologies</title>
</head>

<body>
    

    <main id="champions">      
        <h1 class="lg-heading">
            <span class="text-secondary">Champions Technologies</span>
        </h1>
        <h2 class="sm-heading">
            Waltham, U.S.A (July 2014 - Dec 2014)
        </h2>
        
            <div clas="bio"></div>
            <h3 class="text-secondary">Software Development</h3>
            <p> Developed a stock and inventory software to maintain and update daily stock for upto 4 stores for Champions Technologies, Rwanda. The software was primarily written in <b class="glow">C#</b>, the editor was <b class="glow">Visual Studio 2008.</b> The data display was using a single form for all stores. I used a DataGrid object to interface the Access database as the backend. Events were generated to Add, Update and Delete new items to the database. </p>

            <div class="bio">
                <h3 class="text-secondary">Code for database operations</h3>
                

                <div class="OISCSFileSection">
                    <pre class="csharpcode">
<span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Text;
<span class="kwrd">using</span> System.Data;
<span class="kwrd">using</span> System.Data.OleDb;
<span class="kwrd">using</span> System.Windows.Forms;
<span class="kwrd">using</span> System.Windows;

<span class="kwrd">namespace</span> ChampionsTechnologies
{
    <span class="kwrd">public</span> <span class="kwrd">class</span> ChampionsHelper
    {
        <span class="rem">// Declare the Oledb class variables</span>
        OleDbCommand command = <span class="kwrd">new</span> OleDbCommand();
        
        OleDbConnection connect = <span class="kwrd">new</span> OleDbConnection();
        
        OleDbDataReader reader;
        <span class="rem">//OleDbDataAdapter adapter = new OleDbDataAdapter();</span>
        <span class="rem">//DataSet ds = new DataSet();</span>

        <span class="rem">// declare strings </span>
        String dbName = <span class="str">"StockSheet"</span>;
        String formLoadBeginString = <span class="str">"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Champions\\ChampionsTechnologies\\ChampionsTechnologies\\bin\\StockSheet.accdb"</span>;

        <span class="rem">// DateTime variable</span>
        DateTime dateVariable = <span class="kwrd">new</span> DateTime();
        DateTime fromdateVariable = <span class="kwrd">new</span> DateTime();
        DateTime todateVariable = <span class="kwrd">new</span> DateTime();

        <span class="rem">// AutoCompleteStringCollection</span>
        <span class="rem">//AutoCompleteStringCollection theItemsList = new AutoCompleteStringCollection();</span>

        <span class="kwrd">public</span> FrmHelper m_Helper;
        <span class="kwrd">public</span> ChampionsHelper()
        {
        }
        <span class="kwrd">public</span> ChampionsHelper(FrmHelper mHelper)
        {
            m_Helper = mHelper;
            <span class="rem">//connect.ConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Kamal CHA documents\\Champions\\ChampionsTechnologies\\ChampionsTechnologies\\bin\\Debug\\" + dbName + ".accdb";</span>
            connect.ConnectionString = formLoadBeginString;
        }

        <span class="kwrd">public</span> <span class="kwrd">void</span> connOpen()
        {
            <span class="kwrd">if</span> (connect.State != ConnectionState.Open)
            {
                <span class="kwrd">try</span>
                {                    
                    connect.Open();                    
                }
                <span class="kwrd">catch</span> (System.Exception ex)
                {
                    MessageBox.Show(ex.Message.ToString() + <span class="str">" !!! Problem opening a connection to database !!! "</span>);
                }
            }
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> connClose()
        {
            <span class="kwrd">if</span> (connect.State != ConnectionState.Closed)
            {
                <span class="kwrd">try</span>
                {
                    connect.Close();                    
                }
                <span class="kwrd">catch</span> (System.Exception ex)
                {
                    MessageBox.Show(ex.Message.ToString() + <span class="str">" !!! Problem closing the connection to database !!! "</span>);
                }
            }
        }
        <span class="rem">// </span>
        <span class="kwrd">public</span> <span class="kwrd">void</span> StringEmptyQuery()
        {
            reader.Close();
            m_Helper.frm_comboBoxItems.Items.Clear(); <span class="rem">// clear if the SelectedText is empty and user wants to keep checking different dates</span>
            m_Helper.frm_comboBoxIN.Items.Clear(); <span class="rem">// clear so that user can check on different dates</span>
            m_Helper.frm_comboBoxOUT.Items.Clear(); <span class="rem">// clear so that user can check on different dates</span>
            <span class="rem">//ClearFields();</span>
            command.CommandText = <span class="str">"SELECT Items,IN_Name,OUT_Name from "</span> + dbName + <span class="str">" WHERE Date_of_Inv = #"</span> + dateVariable.ToShortDateString() + <span class="str">"# "</span>;

            reader = command.ExecuteReader();
            <span class="rem">//populate the combobox with items for that date</span>
            <span class="kwrd">while</span> (reader.Read())
            {
                m_Helper.frm_comboBoxItems.Items.Add(reader[<span class="str">"Items"</span>].ToString());
                m_Helper.frm_comboBoxIN.Items.Add(reader[<span class="str">"IN_Name"</span>].ToString());
                m_Helper.frm_comboBoxOUT.Items.Add(reader[<span class="str">"OUT_Name"</span>].ToString());
                <span class="rem">//m_Helper.frm_comboBoxIN.Items.Add(reader["OUT_Name"].ToString());</span>
                <span class="rem">//m_Helper.frm_comboBoxOUT.Items.Add(reader["IN_Name"].ToString());</span>
            }
            m_Helper.frm_lblItems.Text = <span class="str">""</span>;
            m_Helper.frm_lblItems.Text = <span class="str">" Total items in inventory  for "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;
            m_Helper.frm_lblItems.Text += <span class="str">"= "</span> + m_Helper.frm_comboBoxItems.Items.Count.ToString() + <span class="str">" "</span>;
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> clearTextfrmCombobox_Click()
        {
            
            connClose();
            connOpen();
            m_Helper.frm_comboBoxItems.Text = String.Empty;
            m_Helper.frm_comboBoxIN.Text = String.Empty;
            m_Helper.frm_comboBoxOUT.Text = String.Empty;
            ClearFields();
            StringEmptyQuery();
        }
        <span class="rem">//</span>
        <span class="kwrd">public</span> <span class="kwrd">void</span> InitValues()
        {
            <span class="kwrd">if</span>(m_Helper.frm_start_of_Day.Text == String.Empty)
                m_Helper.frm_start_of_Day.Text = <span class="str">"0"</span>;
           
            <span class="kwrd">if</span>(m_Helper.frm_in_Inventory.Text == String.Empty)
                m_Helper.frm_in_Inventory.Text = <span class="str">"0"</span>;

            <span class="kwrd">if</span>(m_Helper.frm_out_Inventory.Text == String.Empty)
                m_Helper.frm_out_Inventory.Text = <span class="str">"0"</span>;

            <span class="kwrd">if</span>(m_Helper.frm_sold.Text == String.Empty)
                m_Helper.frm_sold.Text = <span class="str">"0"</span>;

            <span class="kwrd">if</span> (m_Helper.frm_stock.Text == String.Empty)
                m_Helper.frm_stock.Text = <span class="str">"0"</span>;

            <span class="kwrd">if</span>(m_Helper.frm_cost.Text == String.Empty)
                m_Helper.frm_cost.Text = <span class="str">"0"</span>;
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> FormLoadBegin()
        {
            <span class="rem">// theItemsList.Clear();</span>
            connClose(); <span class="rem">// close any previous connections</span>

            connOpen();
            
            command.Connection = connect;
            

            <span class="rem">// default date to today</span>
            dateVariable = m_Helper.frm_monthCalendar1.TodayDate;

            <span class="rem">// disable the todateVariable , enable it when user selects fromdateVariable</span>
            <span class="rem">//m_Helper.frm_monthCalendarTo.Enabled = false;</span>

            command.CommandText = <span class="str">"SELECT Items,IN_Name,OUT_Name from "</span> + dbName + <span class="str">" WHERE Date_of_Inv = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#"</span>;
            <span class="kwrd">bool</span> hasTodayRows = <span class="kwrd">false</span>;
                            
            reader = command.ExecuteReader();
            <span class="rem">// </span>
            <span class="kwrd">if</span> (reader.HasRows)
            {
                <span class="kwrd">while</span> (reader.Read())
                {
                    <span class="rem">//theItemsList.Add(reader["Items"].ToString());</span>
                    m_Helper.frm_comboBoxItems.Items.Add(reader[<span class="str">"Items"</span>].ToString());
                    m_Helper.frm_comboBoxIN.Items.Add(reader[<span class="str">"IN_Name"</span>].ToString());
                    m_Helper.frm_comboBoxOUT.Items.Add(reader[<span class="str">"OUT_Name"</span>].ToString());
                }
                hasTodayRows = <span class="kwrd">true</span>;
            }
            
            reader.Close();
            command.Cancel();
            connClose();
                        
            <span class="kwrd">if</span> (!hasTodayRows)
            {
                <span class="rem">// no rows for today so transfer from  </span>
                <span class="rem">// last known date to today and display a message</span>

                <span class="rem">// theItemsList.Clear();</span>
                connClose(); <span class="rem">// close any previous connections</span>

                connOpen();

                command.Connection = connect;

                command.CommandText = <span class="str">"INSERT INTO "</span> + dbName + <span class="str">" "</span> +
                                            <span class="str">" ([Date_of_Inv],"</span> +
                                            <span class="str">" Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost )"</span> +
                                            <span class="str">"  SELECT TOP 1 #"</span> + dateVariable.ToShortDateString() + <span class="str">"#,"</span> +
                                            <span class="str">" Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock ,Cost "</span> +
                                            <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                            <span class="str">" WHERE ( ([Date_of_Inv]) &lt;&gt;  ( #"</span> + dateVariable.ToShortDateString() + <span class="str">"# )  )"</span> +
                                            <span class="str">" ORDER BY Date_of_Inv DESC"</span>;

                reader = command.ExecuteReader();
                <span class="kwrd">int</span> count = reader.RecordsAffected;
                <span class="rem">//                 </span>
                <span class="kwrd">if</span> (reader.HasRows)
                {
                    <span class="kwrd">while</span> (reader.Read())
                    {
                        <span class="rem">//theItemsList.Add(reader["Items"].ToString());</span>
                        m_Helper.frm_comboBoxItems.Items.Add(reader[<span class="str">"Items"</span>].ToString());
                        m_Helper.frm_comboBoxIN.Items.Add(reader[<span class="str">"IN_Name"</span>].ToString());
                        m_Helper.frm_comboBoxOUT.Items.Add(reader[<span class="str">"OUT_Name"</span>].ToString());
                    }
                    hasTodayRows =<span class="kwrd">false</span>;
                } <span class="rem">// end if (reader.HasRows)</span>
                
                MessageBox.Show(<span class="str">"Software has successfully transferred   "</span> + count + <span class="str">"  Items from the last known date to "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>);

            } <span class="rem">// end if (!hasTodayRows)</span>

            reader.Close();
            command.Cancel();
            connClose();

            connOpen();
            StringEmptyQuery();
            connClose();

        } <span class="rem">// end public void FormLoadBegin()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> ClearFields()
        {
            m_Helper.frm_start_of_Day.Clear();
            m_Helper.frm_in_Inventory.Clear();
            m_Helper.frm_out_Inventory.Clear();
            m_Helper.frm_sold.Clear();
            m_Helper.frm_stock.Clear();
            m_Helper.frm_cost.Clear();
            m_Helper.frm_comboBoxIN.Text = String.Empty;
            m_Helper.frm_comboBoxOUT.Text = String.Empty;
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> ClearTexts()
        {
            m_Helper.frm_lblItems.Text = <span class="str">""</span>;
            m_Helper.frm_lblResult.Text = <span class="str">""</span>;
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> CloseForm()
        {
            m_Helper.frm_comboBoxItems.Items.Clear();
            m_Helper.frm_comboBoxIN.Items.Clear();
            m_Helper.frm_comboBoxOUT.Items.Clear();
            ClearFields();
            ClearTexts();
            reader.Close();
            command.Cancel();
            connClose();
            
        }
        <span class="kwrd">public</span> <span class="kwrd">void</span> DeleteItem()
        {
            connClose(); <span class="rem">// close previous connections if any</span>
            
            connOpen(); <span class="rem">// open the connection again</span>
            <span class="kwrd">if</span> ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.Text == String.Empty))
            {
                MessageBox.Show(<span class="str">" PLEASE SELECT A VALID DATE AND ITEM TO DELETE "</span>);
            }
            <span class="kwrd">else</span>
            {
                reader.Close();
                command.CommandText =   <span class="str">"DELETE Date_of_Inv, Items , "</span> +
                                        <span class="str">" Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost "</span> +
                                        <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                        <span class="str">" WHERE (((Date_of_Inv) = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#) "</span> +
                                        <span class="str">" AND ((Items) = '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"'))"</span>;

                DialogResult dialogResult = MessageBox.Show(<span class="str">" Delete ''"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"'' from Stock data for "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>, <span class="str">"DELETE"</span>, MessageBoxButtons.YesNo);
                
                <span class="kwrd">if</span> (dialogResult == DialogResult.Yes)
                {
                    reader = command.ExecuteReader();
                    ClearFields();
                    
                    m_Helper.frm_comboBoxItems.Text = String.Empty;
                    m_Helper.frm_comboBoxIN.Text = String.Empty;
                    m_Helper.frm_comboBoxOUT.Text = String.Empty;

                    connClose();
                    connOpen();
                    StringEmptyQuery();                                        
                }
                <span class="kwrd">else</span> <span class="kwrd">if</span> (dialogResult == DialogResult.No)
                {
                    <span class="rem">// these lines are commented from previous delete function</span>
                    <span class="rem">// turn them on if needed</span>
                    <span class="rem">//m_Helper.frm_comboBoxItems.Items.Clear();</span>
                    <span class="rem">//m_Helper.frm_comboBoxItems.Text = String.Empty;</span>
                    <span class="rem">//ClearFields();</span>
                }

            } <span class="rem">// end else ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.SelectedText == String.Empty))</span>
            connClose();
        } <span class="rem">// end DeleteItem()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> monthCalendar1_DateChanged()
        {
            ClearTexts();
            ClearFields();

            dateVariable = m_Helper.frm_monthCalendar1.SelectionStart; <span class="rem">// Assign the dateVariable            </span>
            m_Helper.frm_lblResult.Text = <span class="str">" You Selected : "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;
            
            <span class="rem">//m_Helper.frm_comboBoxItems.SelectedText = String.Empty;</span>
            connClose();
            connOpen();

            <span class="kwrd">if</span> (m_Helper.frm_comboBoxItems.Text == String.Empty) <span class="rem">// select all items into comboboxItems.Items</span>
            {
                <span class="rem">//reader.Close();</span>
                <span class="rem">//m_Helper.frm_comboBoxItems.Items.Clear(); // clear if the SelectedText is empty and user wants to keep checking different dates</span>
                <span class="rem">////ClearFields();</span>
                <span class="rem">//command.CommandText = "SELECT Items from " + dbName + " WHERE Date_of_Inv = #" + dateVariable.ToShortDateString() + "# ";</span>

                <span class="rem">//reader = command.ExecuteReader();</span>
                <span class="rem">////populate the combobox with items for that date</span>
                <span class="rem">//while (reader.Read())</span>
                <span class="rem">//{</span>
                <span class="rem">//    m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                <span class="rem">//}</span>
                <span class="rem">//m_Helper.frm_lblItems.Text = "";</span>
                <span class="rem">//m_Helper.frm_lblItems.Text = " Total items in inventory  for " + dateVariable.ToLongDateString() + " ";</span>
                <span class="rem">//m_Helper.frm_lblItems.Text += "= " + m_Helper.frm_comboBoxItems.Items.Count.ToString() + " ";</span>
                StringEmptyQuery();

            }
            <span class="kwrd">else</span> <span class="rem">// m_Helper.frm_comboBoxItems.Text has some text</span>
            {
                reader.Close();
                ClearFields();
                String selText = m_Helper.frm_comboBoxItems.Text;
                
                
                command.CommandText =   <span class="str">"SELECT Items , "</span> +
                                        <span class="str">" Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock ,Cost "</span> +
                                        <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                        <span class="str">" WHERE (((Date_of_Inv) = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#) "</span> +
                                        <span class="str">" AND ((Items) = '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"'))"</span>;

                
                reader = command.ExecuteReader();
                <span class="rem">//m_Helper.frm_comboBoxItems.Items.Clear(); //clear all items in list and add items in while for that date</span>
                <span class="rem">//m_Helper.frm_comboBoxItems.SelectedText = String.Empty;</span>
                <span class="kwrd">while</span> (reader.Read())
                {
                    <span class="rem">//m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                    m_Helper.frm_start_of_Day.Text = reader[<span class="str">"Start_of_Day"</span>].ToString();
                    m_Helper.frm_in_Inventory.Text = reader[<span class="str">"IN_Inv"</span>].ToString();
                    m_Helper.frm_comboBoxIN.Text = reader[<span class="str">"IN_Name"</span>].ToString();
                    m_Helper.frm_out_Inventory.Text = reader[<span class="str">"OUT_Inv"</span>].ToString();
                    m_Helper.frm_comboBoxOUT.Text = reader[<span class="str">"OUT_Name"</span>].ToString();
                    m_Helper.frm_sold.Text = reader[<span class="str">"sold"</span>].ToString();
                    m_Helper.frm_stock.Text = reader[<span class="str">"stock"</span>].ToString();
                    m_Helper.frm_cost.Text = reader[<span class="str">"cost"</span>].ToString();
                } <span class="rem">//end while (reader.Read())</span>

                <span class="rem">// get the IN_Name and OUT_Name from the current selected Item and date</span>
                String selIN_Name = m_Helper.frm_comboBoxIN.Text;
                String selOUT_Name = m_Helper.frm_comboBoxOUT.Text;
                StringEmptyQuery();
                m_Helper.frm_comboBoxItems.Text = selText;
                m_Helper.frm_comboBoxIN.Text = selIN_Name; <span class="rem">// reproduce</span>
                m_Helper.frm_comboBoxOUT.Text = selOUT_Name; <span class="rem">// reproduce</span>

            } <span class="rem">// end if (m_Helper.frm_comboBoxItems.Text == String.Empty) // select all items into comboboxItems.Items</span>

            <span class="rem">// before closing the function</span>
            <span class="rem">//ClearFields();</span>
            <span class="rem">//ClearTexts();</span>
            <span class="rem">//reader.Close();</span>
            <span class="rem">//command.Cancel();</span>
            <span class="rem">//dateVariable = DateTime.MinValue;</span>
            connClose();
        } <span class="rem">// end public void monthCalendar1_DateChanged()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> comboBoxItems_SelectedIndexChanged()
        {
            ClearTexts();
            ClearFields();          
            
            connClose();
            connOpen();

            m_Helper.frm_lblResult.Text = <span class="str">" You Selected : "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;

           
            <span class="kwrd">if</span> (m_Helper.frm_comboBoxItems.Text == String.Empty)
            {
                <span class="rem">//reader.Close();</span>
                <span class="rem">//m_Helper.frm_comboBoxItems.Items.Clear();</span>
                <span class="rem">//command.CommandText = "SELECT Items from " + dbName + " WHERE Date_of_Inv = #" + dateVariable.ToShortDateString() + "# ";</span>

                <span class="rem">//reader = command.ExecuteReader();</span>
                
                <span class="rem">//while (reader.Read())</span>
                <span class="rem">//{</span>
                <span class="rem">//    m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                <span class="rem">//}</span>
                <span class="rem">//m_Helper.frm_lblItems.Text = "";</span>
                <span class="rem">//m_Helper.frm_lblItems.Text = " Total items in inventory  for " + dateVariable.ToLongDateString() + " ";</span>
                <span class="rem">//m_Helper.frm_lblItems.Text += "= " + m_Helper.frm_comboBoxItems.Items.Count.ToString() + " ";</span>
                StringEmptyQuery();
            }
            <span class="kwrd">else</span>
            {
                reader.Close();
                ClearFields();

                command.CommandText =   <span class="str">"SELECT Items , "</span> +
                                        <span class="str">" Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost "</span> +
                                        <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                        <span class="str">" WHERE (((Date_of_Inv) = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#) "</span> +
                                        <span class="str">" AND ((Items) = '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"'))"</span>;

                reader = command.ExecuteReader();
                String selText = m_Helper.frm_comboBoxItems.Text;
                <span class="rem">//String selIN_Name = m_Helper.frm_comboBoxIN.Text;</span>
                <span class="rem">//String selOUT_Name = m_Helper.frm_comboBoxOUT.Text;</span>

                <span class="rem">//m_Helper.frm_comboBoxItems.Items.Clear();</span>
                <span class="kwrd">while</span> (reader.Read())
                {
                    <span class="rem">//m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                    <span class="kwrd">if</span> (m_Helper.frm_comboBoxItems.Items.Contains(reader[<span class="str">"Items"</span>].ToString()))
                    {
                        <span class="rem">//m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                        m_Helper.frm_comboBoxItems.Text = selText;
                        m_Helper.frm_start_of_Day.Text = reader[<span class="str">"Start_of_Day"</span>].ToString();
                        m_Helper.frm_in_Inventory.Text = reader[<span class="str">"IN_Inv"</span>].ToString();
                        m_Helper.frm_comboBoxIN.Text = reader[<span class="str">"IN_Name"</span>].ToString();
                        m_Helper.frm_out_Inventory.Text = reader[<span class="str">"OUT_Inv"</span>].ToString();
                        m_Helper.frm_comboBoxOUT.Text = reader[<span class="str">"OUT_Name"</span>].ToString();
                        m_Helper.frm_sold.Text = reader[<span class="str">"sold"</span>].ToString();
                        m_Helper.frm_stock.Text = reader[<span class="str">"stock"</span>].ToString();
                        m_Helper.frm_cost.Text = reader[<span class="str">"cost"</span>].ToString();
                    }
                    <span class="kwrd">else</span>
                    {
                        m_Helper.frm_comboBoxItems.Items.Add(reader[<span class="str">"Items"</span>].ToString());
                        <span class="rem">//m_Helper.frm_comboBoxIN.Items.Add(reader["IN_Name"].ToString());</span>
                        <span class="rem">//m_Helper.frm_comboBoxOUT.Items.Add(reader["OUT_Name"].ToString());</span>
                    }
                    
                } <span class="rem">// end while (reader.Read())                </span>

                m_Helper.frm_lblItems.Text = <span class="str">""</span>;
                m_Helper.frm_lblItems.Text = <span class="str">" Total items in inventory  for "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;
                m_Helper.frm_lblItems.Text += <span class="str">"= "</span> + m_Helper.frm_comboBoxItems.Items.Count.ToString() + <span class="str">" "</span>;
            } <span class="rem">// end if (m_Helper.frm_comboBoxItems.Text == String.Empty)</span>


            reader.Close();
            connClose();
        }<span class="rem">// end public void comboBoxItems_SelectedIndexChanged()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> btnAdd_Click()
        {
            InitValues();
            connClose(); <span class="rem">// close previous connections if any</span>

            connOpen(); <span class="rem">// open the connection again</span>
            <span class="kwrd">if</span> ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.Text == String.Empty))
            {
                MessageBox.Show(<span class="str">" PLEASE SELECT A VALID DATE AND ITEM TO ADD "</span>);
            }
            <span class="kwrd">else</span>
            {
                reader.Close();
                command.CommandText = <span class="str">"SELECT Items "</span> +                                       
                                       <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                       <span class="str">" WHERE (((Date_of_Inv) = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#) "</span> +
                                       <span class="str">" AND ((Items) = '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"'))"</span>;

                reader = command.ExecuteReader();
                String selText = m_Helper.frm_comboBoxItems.Text;
                <span class="kwrd">while</span> (reader.Read())
                {
                    <span class="kwrd">if</span> (m_Helper.frm_comboBoxItems.Items.Contains(reader[<span class="str">"Items"</span>].ToString()))
                    {
                        MessageBox.Show(<span class="str">" YOU ARE ENTERING THE SAME ITEM TWICE, CHANGE DATE OR ITEM "</span>);
                        m_Helper.frm_comboBoxItems.Text = String.Empty;
                        <span class="kwrd">return</span>;
                    }
                }
                <span class="kwrd">int</span> tempStock = <span class="kwrd">int</span>.Parse(m_Helper.frm_start_of_Day.Text) + <span class="kwrd">int</span>.Parse(m_Helper.frm_in_Inventory.Text) - <span class="kwrd">int</span>.Parse(m_Helper.frm_out_Inventory.Text) - <span class="kwrd">int</span>.Parse(m_Helper.frm_sold.Text);
                String tmpStock = tempStock.ToString();
                reader.Close();
                command.CommandText = <span class="str">"INSERT INTO "</span> + dbName + <span class="str">" "</span> +
                        <span class="str">" ([Date_of_Inv], Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost )"</span> +
                        <span class="str">" VALUES (#"</span> + dateVariable.ToShortDateString() + <span class="str">"#, "</span> +
                        <span class="str">" '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"',"</span> +
                        <span class="str">" "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_start_of_Day.Text) + <span class="str">", "</span> +
                        <span class="str">" "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_in_Inventory.Text) + <span class="str">", "</span> +
                        <span class="str">" '"</span> + m_Helper.frm_comboBoxIN.Text + <span class="str">"',"</span> +
                        <span class="str">" "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_out_Inventory.Text) + <span class="str">", "</span> +
                        <span class="str">" '"</span> + m_Helper.frm_comboBoxOUT.Text + <span class="str">"',"</span> +
                        <span class="str">" "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_sold.Text) + <span class="str">", "</span> +
                        <span class="str">" "</span> + tempStock + <span class="str">", "</span> +
                        <span class="str">" "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_cost.Text) + <span class="str">") "</span>;

                command.ExecuteReader();
                m_Helper.frm_stock.Text = tmpStock;
                m_Helper.frm_lblResult.Text = <span class="str">""</span>;
                m_Helper.frm_lblResult.Text = <span class="str">"You added the following Item : "</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">" "</span>;
                m_Helper.frm_lblResult.Text += <span class="str">" on "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;                
            } <span class="rem">// end else ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.Text == String.Empty))</span>
            connClose();
        } <span class="rem">// end public void btnAdd_Click</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> btnChange_Click()
        {
            InitValues();
            connClose(); <span class="rem">// close previous connections if any</span>

            connOpen(); <span class="rem">// open the connection again</span>
            <span class="kwrd">if</span> ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.Text == String.Empty))
            {
                MessageBox.Show(<span class="str">" PLEASE SELECT A VALID DATE AND ITEM TO UPDATE "</span>);
            }
            <span class="kwrd">else</span>
            {
                m_Helper.frm_stock.Enabled = <span class="kwrd">false</span>;
                <span class="kwrd">int</span> tempStock = <span class="kwrd">int</span>.Parse(m_Helper.frm_start_of_Day.Text) + <span class="kwrd">int</span>.Parse(m_Helper.frm_in_Inventory.Text) - <span class="kwrd">int</span>.Parse(m_Helper.frm_out_Inventory.Text) - <span class="kwrd">int</span>.Parse(m_Helper.frm_sold.Text);
                
                reader.Close();
                
                command.CommandText = <span class="str">"UPDATE "</span> + dbName + <span class="str">" "</span> +
                    <span class="str">" SET "</span> +
                    <span class="str">" Start_of_Day = "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_start_of_Day.Text) + <span class="str">", "</span> +
                     <span class="str">" IN_Inv = "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_in_Inventory.Text) + <span class="str">", "</span> +
                     <span class="str">" IN_Name = '"</span> + m_Helper.frm_comboBoxIN.Text + <span class="str">"', "</span> +
                     <span class="str">" OUT_Inv = "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_out_Inventory.Text) + <span class="str">", "</span> +
                     <span class="str">" OUT_Name = '"</span> + m_Helper.frm_comboBoxOUT.Text + <span class="str">"', "</span> +                      
                     <span class="str">" Sold = "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_sold.Text) + <span class="str">", "</span> +
                     <span class="str">"Stock = "</span> +tempStock+ <span class="str">", "</span> +
                     <span class="str">"Cost = "</span> + <span class="kwrd">int</span>.Parse(m_Helper.frm_cost.Text) + <span class="str">"  "</span>+
                     <span class="str">" WHERE "</span> +
                     <span class="str">" (([Date_of_Inv] = #"</span> + dateVariable.ToShortDateString() + <span class="str">"# )"</span> +
                     <span class="str">" AND "</span> +
                     <span class="str">" (Items = '"</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">"' ))"</span>; 
                
                command.ExecuteReader();
                m_Helper.frm_stock.Text = <span class="str">""</span> +tempStock+<span class="str">""</span>;
                m_Helper.frm_lblResult.Text = <span class="str">""</span>;
                m_Helper.frm_lblResult.Text = <span class="str">"You changed the following Item : "</span> + m_Helper.frm_comboBoxItems.Text + <span class="str">" "</span>;
                m_Helper.frm_lblResult.Text += <span class="str">" on "</span> + dateVariable.ToLongDateString() + <span class="str">" "</span>;
            } <span class="rem">// end else ((dateVariable == DateTime.MinValue) || (m_Helper.frm_comboBoxItems.Text == String.Empty))</span>
            connClose();

        } <span class="rem">// end public void btnChange_Click()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> monthCalendarFrom_DateChanged()
        {
            fromdateVariable =  m_Helper.frm_monthCalendarFrom.SelectionStart; <span class="rem">// Assign the from Date</span>
            <span class="rem">//m_Helper.frm_lblResult.Text = "SELECT A VALID DATE TO TRANSFER DATA BY SELECTING A DATE FROM TODATE CALENDAR";</span>
            <span class="rem">// enable the toDateVariable</span>
            <span class="rem">//m_Helper.frm_monthCalendarTo.Enabled = true;</span>
        } <span class="rem">// end public void monthCalendarFrom_DateChanged()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> monthCalendarTo_DateChanged()
        {
            todateVariable = m_Helper.frm_monthCalendarTo.SelectionStart; <span class="rem">// Assign the todateVariable</span>

            <span class="rem">//m_Helper.frm_monthCalendarTo.Enabled = false;</span>
            <span class="rem">// validate both from and to dates</span>
            <span class="kwrd">if</span> (fromdateVariable.ToShortDateString() == todateVariable.ToShortDateString())
            {
                MessageBox.Show(<span class="str">"Enter a different date to transfer data, you cannot transfer data to the same day"</span>);
                <span class="kwrd">return</span>;
            } <span class="rem">// end if</span>
            
            connClose(); <span class="rem">// close any previous connections</span>
            connOpen();                
            reader.Close();
                
            command.CommandText = <span class="str">"SELECT Items,IN_Name,OUT_Name from "</span> + dbName + <span class="str">" WHERE Date_of_Inv = #"</span> + todateVariable.ToShortDateString() + <span class="str">"#"</span>;
            <span class="rem">//bool hasTodayRows = false;</span>

            reader = command.ExecuteReader();
            <span class="kwrd">int</span> count = reader.RecordsAffected;
            <span class="kwrd">if</span> (reader.HasRows)
            {
                MessageBox.Show(<span class="str">"You have Items in database for "</span> + todateVariable.ToLongDateString() + <span class="str">" cannot transfer because items may get repeated "</span>);
                <span class="rem">//hasTodayRows = true;</span>
                reader.Close();
                command.Cancel();
                connClose();
                <span class="kwrd">return</span>;
            } <span class="rem">// end if (reader.HasRows)</span>


            <span class="kwrd">else</span> 
            {
                <span class="rem">// no rows for today so transfer from  </span>
                <span class="rem">// last known date to today and display a message</span>

                <span class="rem">// theItemsList.Clear();</span>
                connClose(); <span class="rem">// close any previous connections</span>

                connOpen();
                reader.Close();
                command.Connection = connect;

                <span class="rem">//command.CommandText = "INSERT INTO " + dbName + " " +</span>
                <span class="rem">//                        " ([Date_of_Inv], Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost )" +</span>
                <span class="rem">//                        "  SELECT #" + todateVariable.ToShortDateString() + "# ," +</span>
                <span class="rem">//                        " Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock ,Cost " +</span>
                <span class="rem">//                        " FROM " + dbName + " " +</span>
                <span class="rem">//                        " WHERE ((Date_of_Inv) = #" + fromdateVariable.ToShortDateString() + "#) ";</span>

                command.CommandText = <span class="str">"INSERT INTO "</span> + dbName + <span class="str">" "</span> +
                                        <span class="str">" ([Date_of_Inv], Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock, Cost )"</span> +
                                        <span class="str">"  SELECT #"</span> + todateVariable.ToShortDateString() + <span class="str">"# ,"</span> +
                                        <span class="str">" Items, Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock ,Cost "</span> +
                                        <span class="str">" FROM "</span> + dbName + <span class="str">" "</span> +
                                        <span class="str">" WHERE ((Date_of_Inv) = #"</span> + fromdateVariable.ToShortDateString() + <span class="str">"#) ORDER BY Items ASC  "</span>;
                reader = command.ExecuteReader();

                count = reader.RecordsAffected;
                MessageBox.Show(<span class="str">"You successfully transferred  "</span> + count + <span class="str">"  Items from "</span> + fromdateVariable.ToLongDateString() + <span class="str">" to "</span> + todateVariable.ToLongDateString() + <span class="str">" "</span>);
                
            } <span class="rem">// end else</span>
         

            reader.Close();
            command.Cancel();
            connClose();
       
        } <span class="rem">// end public void monthCalendarTo_DateChanged()</span>

        <span class="kwrd">public</span> <span class="kwrd">void</span> btndaily_Stock()
        {
            <span class="rem">// theItemsList.Clear();</span>
            connClose(); <span class="rem">// close any previous connections</span>

            connOpen();

            command.Connection = connect;


            <span class="rem">// default date to today</span>
            <span class="rem">//dateVariable = m_Helper.frm_monthCalendar1.TodayDate;            </span>

            command.CommandText = <span class="str">"SELECT Items , Start_of_Day, IN_Inv, IN_Name, OUT_Inv, OUT_Name, Sold, Stock from "</span> +
                                    <span class="str">""</span> + dbName + <span class="str">" WHERE Date_of_Inv = #"</span> + dateVariable.ToShortDateString() + <span class="str">"#"</span>;
            <span class="kwrd">bool</span> hasTodayRows = <span class="kwrd">false</span>;

            reader = command.ExecuteReader();
            <span class="rem">// </span>
            <span class="kwrd">if</span> (reader.HasRows)
            {
                Form2 f2 = <span class="kwrd">new</span> Form2();
                f2.DailyStock = reader; <span class="rem">// Assign the OleDBDataReader </span>
                f2.DateReader = dateVariable.Day.ToString() +<span class="str">"/"</span>+ dateVariable.Month.ToString() + <span class="str">"/"</span> + dateVariable.Year.ToString();
                f2.loadDataGrid();
                f2.Show();
                <span class="rem">//f2.PassReader = reader;</span>
                <span class="rem">//f2.dtReader = dateVariable.ToShortDateString();</span>
                <span class="rem">//f2.Show();</span>

                <span class="rem">//while (reader.Read())</span>
                <span class="rem">//{</span>
                <span class="rem">//    //theItemsList.Add(reader["Items"].ToString());</span>
                <span class="rem">//    m_Helper.frm_comboBoxItems.Items.Add(reader["Items"].ToString());</span>
                <span class="rem">//    m_Helper.frm_comboBoxIN.Items.Add(reader["IN_Name"].ToString());</span>
                <span class="rem">//    m_Helper.frm_comboBoxOUT.Items.Add(reader["OUT_Name"].ToString());</span>
                <span class="rem">//}</span>
                hasTodayRows = <span class="kwrd">true</span>;
            }
            <span class="kwrd">else</span>
            {
                MessageBox.Show(<span class="str">"You do not have any items to view for "</span> + dateVariable.ToLongDateString() + <span class="str">""</span>);
            }

            reader.Close();
            command.Cancel();
            connClose();
        } <span class="rem">// end public void daily_Stock()</span>

    } <span class="rem">// end public class ChampionsHelper</span>
} <span class="rem">// end namespace ChampionsTechnologies</span>
                    </pre>
                </div> <!-- OISCSFileSection-->

            </div>

    </main>

    <footer id="main-footer">
        Copyright &copy; 2020
    </footer>

    <script src="js/main.js"></script>
</body>
</html>