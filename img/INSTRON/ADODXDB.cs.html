<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ADOX Database Object</title>
  <meta http-equiv="generator" content="CoDocker v00.90 Beta (www.OfItselfSo.com)" />
  <meta name="created" content="Sat, Aug 15, 2020" />
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <meta name="description" content="" />
  <link rel="stylesheet" type="text/css" href="CoDocker.css" >
</head>

<body>
<div class="OISHTMLPageBanner">

<div class="OISBannerContent"><span class="OISBannerLabel">File:</span> ADODXDB.cs<BR/>
<span class="OISBannerLabel">Created by:</span> Kamal Shah<BR/>
</div> <!--bannerContent-->
</div> <!--OISHTMLPageBanner-->


<div class="OISCSFileSection">
<pre class="csharpcode">
<span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Text;
<span class="kwrd">using</span> ADOX28 = ADOX;
<span class="kwrd">using</span> ADODB;
<span class="kwrd">using</span> System.Data;
<span class="kwrd">using</span> System.Data.OleDb;



<span class="kwrd">namespace</span> ADOXDB
{
    <span class="kwrd">class</span> Program
    {

         <span class="kwrd">private</span> <span class="kwrd">void</span> Database_CreateValidationResultsTable()
        {
            <span class="rem">//ADOX.Catalog adoxCatalog = new ADOX.Catalog();</span>
            <span class="rem">//ADOX.Table adoxTable;</span>

            <span class="rem">//string strDatabase = "C:\\Personal\\MyDatabase.mdb";</span>
            <span class="rem">//string strTable = "MyTable";</span>
            <span class="rem">//string strConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strDatabase + ";Mode=ReadWrite;Persist Security Info=False";</span>

            <span class="rem">//adoxCatalog.let_ActiveConnection(strConnectionString);</span>

            <span class="rem">////delete the table if it already exists</span>
            <span class="rem">//try</span>
            <span class="rem">//{</span>
            <span class="rem">//    adoxCatalog.Tables.Delete(strTable);</span>
            <span class="rem">//}</span>
            <span class="rem">//catch (Exception error)</span>
            <span class="rem">//{</span>
            <span class="rem">//    //Will error if the table doesn't exist. Could trap other possible errors like the database being read-only</span>
            <span class="rem">//}</span>

            <span class="rem">//adoxTable = new ADOX.Table();</span>

            <span class="rem">//adoxTable.Name = strTable;</span>

            <span class="rem">//adoxTable.Columns.Append("FIELD1", ADOX.DataTypeEnum.adDouble, 0);</span>
            <span class="rem">//adoxTable.Columns.Append("FIELD2", ADOX.DataTypeEnum.adDouble, 0);</span>
            <span class="rem">//adoxTable.Columns.Append("FIELD3", ADOX.DataTypeEnum.adVarWChar, 4);</span>

            <span class="rem">//adoxCatalog.Tables.Append(adoxTable);</span>
        }

        <span class="kwrd">private</span> <span class="kwrd">void</span> Database_SaveValidationResults()
        {
            <span class="rem">//Database_CreateValidationResultsTable();</span>

            <span class="rem">//ADODB.Connection cnn = new ADODB.Connection();</span>
            <span class="rem">//ADODB.Recordset rst = new ADODB.Recordset();</span>

            <span class="rem">//string strDatabase = "C:\\Personal\\MyDatabase.mdb";</span>
            <span class="rem">//string strTable = "MyTable";</span>

            <span class="rem">//cnn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" + strDatabase + "'", "Admin", "", 0);</span>
            <span class="rem">//rst.Open(strTable, cnn, ADODB.CursorTypeEnum.adOpenStatic, ADODB.LockTypeEnum.adLockPessimistic, 0);</span>

            <span class="rem">////foreach (DataGridViewRow row in dgWorkplaces.Rows)</span>
            <span class="rem">////{</span>
            <span class="rem">//    rst.AddNew(System.Reflection.Missing.Value, System.Reflection.Missing.Value);</span>

            <span class="rem">//    rst.Fields["FIELD1"].Value = row.Cells["colMINE"].Value.ToString();</span>
            <span class="rem">//    rst.Fields["FIELD2"].Value = row.Cells["colLEVEL"].Value.ToString();</span>
            <span class="rem">//    rst.Fields["FIELD3"].Value = row.Cells["colWORKPLAC"].Value.ToString();</span>

            <span class="rem">//    rst.Update(System.Reflection.Missing.Value, System.Reflection.Missing.Value);</span>
            <span class="rem">////}</span>
        }

        <span class="kwrd">static</span> <span class="kwrd">void</span> Main(<span class="kwrd">string</span>[] args)
        {
            
            
            Console.WriteLine(<span class="str">"OSVersion: {0}"</span>,Environment.OSVersion.ToString());
            ADOX.CatalogClass cat = <span class="kwrd">new</span> ADOX.CatalogClass();
            <span class="rem">//cat.Create("Provider=Microsoft.Jet.OLEDB.4.0;" +</span>
            <span class="rem">//"Data Source=C:\\Personal\\NewMDB.mdb;" +</span>
            <span class="rem">//"Jet OLEDB:Engine Type=5");</span>
            <span class="rem">//Console.WriteLine("Database Created Successfully");</span>

            Console.WriteLine(<span class="str">"Opening connection"</span>);
            <span class="kwrd">string</span> datasource = <span class="str">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\Personal\\NewMDB.mdb;"</span>;
            OleDbConnection conn = <span class="kwrd">new</span> OleDbConnection(datasource);
            conn.Open();

            <span class="rem">//string primKey = "ALTER TABLE MyTable";</span>
            <span class="rem">//primKey += " ADD PrimaryCol TEXT CONSTRAINT primecol_pk PRIMARY KEY";</span>

            <span class="rem">//OleDbCommand newCmd = new OleDbCommand(primKey, conn);</span>
            <span class="rem">//int tblexecuted = newCmd.ExecuteNonQuery(); </span>

            ADODB.Connection cnn = <span class="kwrd">new</span> Connection();
            cnn.Open(conn.ConnectionString, <span class="str">""</span>, <span class="str">""</span>, 0);
            cat.ActiveConnection = cnn;
            Console.WriteLine(<span class="str">"Creating Table"</span>);
            ADOX.Table adoxTable = <span class="kwrd">new</span> ADOX.TableClass();

            <span class="kwrd">string</span> mytab = <span class="str">"MyTable"</span>;
            adoxTable = cat.Tables[mytab];
            <span class="rem">//adoxTable.Name = mytab;</span>


            <span class="rem">//adoxTable.Columns.Append("PrimaryCol", ADOX.DataTypeEnum.adLongVarWChar, 0);</span>

            <span class="rem">//adoxTable.Keys.Append("PrimaryKey", KeyTypeEnum.adKeyPrimary, "PrimaryCol", "", "");</span>


            <span class="rem">//cat.Tables.Append(adoxTable);</span>
            <span class="rem">//ADOX.TableClass adoxTable = new TableClass();</span>
            <span class="rem">//adoxTable = cat.Tables["MyTable"];</span>
           
            <span class="rem">//adoxTable.Name = "MyTable";</span>
            <span class="rem">//adoxTable.ParentCatalog = cat;</span>
            
            <span class="rem">//cat.Tables.Append(adoxTable);</span>
            
            
            <span class="rem">//ADOX.ColumnClass adoxPrimary = new ColumnClass();</span>
            <span class="rem">//adoxPrimary.Name = "PrimaryCol";</span>
            <span class="rem">//adoxPrimary.Type = ADOX.DataTypeEnum.adInteger;</span>

            <span class="rem">//adoxTable.Columns.Append(adoxPrimary, ADOX.DataTypeEnum.adInteger, 0);</span>


            <span class="rem">//ADOX.KeyClass adoxPrimaryKey = new KeyClass();</span>
            <span class="rem">//adoxPrimaryKey.Name = "PrimaryKey";</span>
            <span class="rem">//adoxPrimaryKey.Type = KeyTypeEnum.adKeyPrimary;</span>


            <span class="rem">//adoxPrimaryKey.Columns.Append(adoxPrimaryKey, ADOX.DataTypeEnum.adInteger, 255);</span>

            <span class="rem">//adoxTable.Keys.Append(adoxPrimaryKey, KeyTypeEnum.adKeyPrimary, adoxPrimary, "", "");</span>
            
            <span class="rem">//adoxPrimary.Name = "PrimaryCol";</span>
            <span class="rem">//adoxPrimary.Type = ADOX.KeyTypeEnum.adKeyPrimary;</span>

            <span class="rem">//adoxTable.Columns.Append(adoxPrimary, ADOX.DataTypeEnum.adInteger, 0);</span>




            <span class="rem">//adoxTable.Keys.Append("PrimaryKey",KeyTypeEnum.adKeyPrimary,adoxPrimary, "", "");</span>

            Console.WriteLine(<span class="str">"Entering loop"</span>);
            <span class="kwrd">for</span> (<span class="kwrd">int</span> i = 1; i &lt; 4; i++)
            {

                ADOX.ColumnClass adoxColumn = <span class="kwrd">new</span> ColumnClass();
                adoxColumn.ParentCatalog = cat;
                adoxColumn.Name = <span class="str">"Column 3 nEW"</span> + i.ToString();
                <span class="rem">//adoxColumn.Type = ADOX.DataTypeEnum.adDate;</span>
                <span class="rem">//adoxColumn.Type = ADOX.DataTypeEnum.adInteger;</span>
                adoxColumn.Type = ADOX.DataTypeEnum.adLongVarWChar;
                <span class="rem">//adoxColumn.Attributes = ColumnAttributesEnum.adColNullable;</span>
                <span class="rem">//adoxColumn.Attributes = ColumnAttributesEnum.adColNullable;</span>
                <span class="rem">//adoxColumn.ParentCatalog = cat;</span>



                adoxColumn.Properties[<span class="str">"Jet OLEDB:Hyperlink"</span>].Value = <span class="kwrd">true</span>;


                adoxTable.Columns.Append(adoxColumn, 0, 0);

                adoxColumn = <span class="kwrd">null</span>;
                Console.WriteLine(<span class="str">"Column appended"</span>);
            }

            <span class="rem">//ADOX.ColumnClass adoxColumn = new ColumnClass();</span>
            <span class="rem">//adoxColumn.Name = "Some New Method";</span>
            <span class="rem">//adoxColumn.Type = ADOX.DataTypeEnum.adInteger;</span>
            <span class="rem">//adoxColumn.ParentCatalog = cat;</span>
            <span class="rem">//adoxTable.Columns.Append(adoxColumn, ADOX.DataTypeEnum.adInteger, 0);</span>
            <span class="rem">//cnn.BeginTrans();</span>
            <span class="rem">//cnn.CommitTrans();</span>
            <span class="rem">//cat = null;</span>
            <span class="rem">//cnn.Close();</span>
            <span class="rem">////conn.Close();</span>
            <span class="rem">//adoxTable = null;</span>
            <span class="rem">////conn.Open();</span>

            <span class="rem">//      string insertQuery = "INSERT INTO MyTable ([Column 3 nEW1]) VALUES ('#http://www.hotmail.com#') WHERE PrimaryCol = 1";</span>

            <span class="rem">//      try</span>
            <span class="rem">//      {</span>
            <span class="rem">//          OleDbCommand cmd = new OleDbCommand(insertQuery, conn);</span>
            <span class="rem">//          int exec = cmd.ExecuteNonQuery();</span>
            <span class="rem">//      }</span>
            <span class="rem">//      catch (OleDbException ex)</span>
            <span class="rem">//      {</span>
            <span class="rem">//          string msg = ex.Message;</span>
            <span class="rem">//      }</span>

            
           
            conn.Close();
            
            <span class="rem">//adoxColumn = null;</span>




            <span class="rem">//ADOX.Catalog adoxCatalog = new ADOX.Catalog();</span>
            <span class="rem">//ADOX.Table adoxTable;</span>

            <span class="rem">//string strDatabase = "C:\\Personal\\MyDatabase.mdb";</span>
            <span class="rem">//string strTable = "MyTable";</span>
            <span class="rem">//string strConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strDatabase + ";Mode=ReadWrite;Persist Security Info=False";</span>

            <span class="rem">//adoxCatalog.let_ActiveConnection(strConnectionString);</span>

            <span class="rem">////delete the table if it already exists</span>
            <span class="rem">//try</span>
            <span class="rem">//{</span>
            <span class="rem">//    adoxCatalog.Tables.Delete(strTable);</span>
            <span class="rem">//}</span>
            <span class="rem">//catch (Exception error)</span>
            <span class="rem">//{</span>
            <span class="rem">//    //Will error if the table doesn't exist. Could trap other possible errors like the database being read-only</span>
            <span class="rem">//}</span>

            <span class="rem">//adoxTable = new ADOX.Table();</span>

            <span class="rem">//adoxTable.Name = strTable;</span>

            <span class="rem">//adoxTable.Columns.Append("FIELD1", ADOX.DataTypeEnum.adDouble, 0);</span>
            <span class="rem">//adoxTable.Columns.Append("FIELD2", ADOX.DataTypeEnum.adDouble, 0);</span>
            <span class="rem">//adoxTable.Columns.Append("FIELD3", ADOX.DataTypeEnum.adVarWChar, 4);</span>

            <span class="rem">//adoxCatalog.Tables.Append(adoxTable);</span>
        }
    }
}
</pre></div> <!-- OISCSFileSection-->

<div class="OISHTMLPageFooter">


</div> <!--OISHTMLPageFooter-->
</body>
</html>
